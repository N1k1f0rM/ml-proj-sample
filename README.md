# Классификация эмоций в русскоязычных комментариях

## Автор
Олег Олегович

## Постановка задачи
Основная задача проекта — дообучить и применить модель для классификации коротких комментариев из социальных сетей на **10 эмоций**:
*   радость
*   печаль
*   гнев
*   энтузиазм
*   удивление
*   отвращение
*   страх
*   вина
*   стыд
*   нейтрально

Подобный инструмент может быть полезен маркетологам или магазинам для анализа отзывов на товары на маркетплейсах и агрегаторах. Использование нейросетевого подхода обосновано необходимостью поиска сложных паттернов, определяющих конкретную эмоцию, а не просто выполнения поверхностной классификации.

---

## Формат данных

### Входные данные
*   **Тип:** Текст (строка на русском языке).
*   **Длина:** Большинство текстов в датасете содержат от 30 до 150 символов. Более короткие и длинные тексты встречаются значительно реже.

### Выходные данные
Модель может возвращать:
1.  Самый уверенный класс (один лейбл).
2.  Несколько наиболее уверенных классов, отсечённых по порогу вероятности (мультилейблинг).

---

## Метрики оценки
Для оценки модели, учитывая многоклассовость и возможный дисбаланс в данных, будут использоваться следующие метрики:

1.  **Macro F1-score** — **основная метрика**.
    *   Равно учитывает качество классификации по всем классам, независимо от их частоты в данных. Критически важна для нашего неравномерного датасета.

2.  **Weighted F1-score** — дополнительная метрика.
    *   Показывает качество с учётом размера (частоты) каждого класса.

**Ожидание на бейзлайне:** Macro F1-score от **0.5 до 0.7**.

---

## Валидация и тестирование

*   Датасет будет разделён на **train**, **validate** и **test**.
*   **Validate** выборка используется в процессе обучения для контроля метрик.
*   **Test** выборка применяется один раз для получения финальной оценки обученной модели.
*   Для обеспечения **воспроизводимости** результатов фиксируется `random seed` для моделей и разбиения данных, а также используется единая версия датасета.

---

## Датасет

*   **Название:** RuGoEmotions (часть набора данных RuIziard)
*   **Источник:** [https://huggingface.co/datasets/Djacon/ru-izard-emotions](https://huggingface.co/datasets/Djacon/ru-izard-emotions)
*   **Описание:** Содержит около 30 тыс. комментариев с Reddit на русском языке.
*   **Объём:** 4.05 MB
*   **Структура:** Имеет предопределённые разделы:
    *   **Обучение (train):** +24 тыс. строк
    *   **Валидация (validation):** +3 тыс. строк
    *   **Тестирование (test):** +3 тыс. строк

**Особенности датасета:**
*   Наличие токсичных комментариев.
*   Дисбаланс классов.
*   В некоторых случаях метка представляет собой комбинацию эмоций.

---

## Моделирование

### Бейзлайн модель
В качестве базовой модели планируется использовать предобученный BERT для русского языка:
*   **Модель:** [DeepPavlov/rubert-base-cased-sentence](https://huggingface.co/DeepPavlov/rubert-base-cased-sentence)

И обучать классификационную голову поверх этого

### Основная модель
В качестве основной будет использоваться та же модель, но дообученная одним из методов:
*   **Полный fine-tuning** всех параметров + Classification head
*   **LoRA (Low-Rank Adaptation)** для эффективной настройки + Classification head

---

## Внедрение

Планируется развертывание сервиса на основе **FastAPI**, который будет предоставлять REST API для классификации текста.

**Технические детали:**
*   На вход сервиса подаётся текстовая строка.
*   На выходе возвращается прогноз модели.
*   Для ускорения инференса может быть использован **Triton Inference Server**.

---
